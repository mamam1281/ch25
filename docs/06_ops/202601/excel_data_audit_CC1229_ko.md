# CC1229업데이트_완료.xlsx 데이터 점검(엑셀 KPI 가능 범위)

대상 파일: [CC1229업데이트_완료.xlsx](../../../CC1229%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8_%EC%99%84%EB%A3%8C.xlsx)

## 1) 결론(한 줄)
- 이 엑셀만으로 **충전(결제) 관련 KPI**는 일별/세그먼트별로 산출 가능하지만, **12/30~1/1 구간 데이터는 포함되어 있지 않아** 해당 기간 기반 KPI/이탈 분석은 불가합니다.

## 2) 보안/개인정보 주의
- 시트에 `핸드폰` 컬럼이 존재합니다(개인정보). 공유/업로드/스크린샷/로그 출력 시 마스킹 권장.

## 3) 시트 구성 요약
### A. 충전 이벤트 로그(정규화에 가장 적합)
- 시트명: `충전로그`
- 컬럼: `날짜`, `순번`, `닉네임`, `원본라벨`, `핸드폰`
- 날짜 커버리지(스캔 기준): **2025-11-15 ~ 2025-12-29**
- 행 수(스캔 기준): **947 rows**
- 용도: 피벗/데이터모델로 **일별 충전건수**, **일별 유니크 충전자**, **기간 필터(예: 12/26~12/29)** 등에 바로 사용 가능

### B. 유저 요약/세그먼트 테이블
- 시트명: `회원요약_그룹재분류`
- 주요 컬럼(발췌): `닉네임`, `닉네임(사이트)`, `최초충전일`, `최근충전일`, `리텐션그룹(업데이트)`, `행동유형`, `메모`, `핸드폰`
- 날짜 커버리지(스캔 기준):
  - `최초충전일`: 2025-11-15 ~ 2025-12-24
  - `최근충전일`: 2025-11-15 ~ **2025-12-29**
- 용도: **리텐션그룹/행동유형/유입 메모(예: 텔레 12/6)** 기반 세그먼트 분포, 충전 로그와 결합(닉네임 키) 시 세그먼트별 KPI 가능

### C. 일별 충전 원본(가로형)
- 시트명: `일별충전원본`
- 특징: 날짜 컬럼이 가로로 펼쳐진 형태(예: “11월 15일”, “충전회원”, “11/16일”, …)
- 용도: 데이터 정규화가 필요하며, 동일 KPI라도 `충전로그`가 더 단순/안정적

### D. 추가 분류 시트(의심/테스트/진상/유지)
- `작업_완전꽁머니`, `1회성_테스트`, `개진상`, `일반_유지`
- 공통 컬럼 패턴: `닉네임`, `최초충전일`, `최근충전일`, `리텐션그룹`, `메모`, `행동유형`, `핸드폰`
- 용도: 운영상 “제외/의심/유지” 그룹 필터링 및 성과 비교에 활용 가능

## 4) 이 파일로 산출 가능한 KPI(추천)
### (1) 일별 충전건수
- 입력: `충전로그`
- 피벗: 행=`날짜`, 값=`행 개수`

### (2) 일별 유니크 충전자 수
- 입력: `충전로그`
- 피벗: 행=`날짜`, 값=`닉네임(고유 개수)`
  - 정확한 고유개수는 **데이터 모델(파워피벗)**에서 `DistinctCount` 사용 권장

### (3) 세그먼트별 충전 기여
- 입력: `충전로그` + `회원요약_그룹재분류` (키: `닉네임`)
- 산출: `리텐션그룹(업데이트)`/`행동유형`별 유니크 충전자, 일별 충전건수 분해

### (4) 사건 전후 비교(현재 파일 범위 내)
- 가능한 비교 예시: 12/24~12/29 구간의 충전 변화, 12/26~12/29 단기 변화

## 5) 이 파일로는 불가능/부정확한 것
- **12/30~1/1** 기간 기반 KPI(데이터 자체가 없음)
- 게임 플레이/로그인/미션 등 **행동 로그 기반 퍼널/DAU/리텐션**
  - 현재 파일은 “충전 중심” 데이터 및 운영 분류표 성격이 강함

## 6) 다음 단계(추가 데이터 요청 스펙)
12/30~1/1을 포함한 분석을 위해 아래 중 하나가 필요합니다.
- (최우선) `충전로그` 형태로 **12/30~1/1 행이 포함된 추가 엑셀/시트**
- (가능하면) 사용자 행동 로그(로그인/플레이/미션완료) 테이블: `user_id(or nick)`, `event_time`, `event_name` 형태

## 7) 재현 메모(로컬 파싱)
- 워크스페이스에 간단 점검 스크립트 추가: [scripts/analyze_excel.py](../../../scripts/analyze_excel.py)
- `openpyxl`로 시트/컬럼/날짜 범위 자동 스캔 결과를 바탕으로 위 내용을 정리함
