# 2025-12-27 Admin System Improvements

## Overview
Comprehensive update to the Admin System focusing on usability, efficiency, and testability. Key improvements include a unified Ticket Management dashboard, enhanced User/Vault search capabilities by External ID, and automated backend verification.

## ğŸš€ Features

### Branding & Identity
-   **Global Name Change**: Updated "XMAS Event" / "í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì´ë²¤íŠ¸" to **"ì”¨ì”¨ì§€ë¯¼ ì½”ë“œì§€ê°‘"** (CC Jimin Code Wallet) in all titles, meta tags, and layouts.

### User Management (CRM Integration)
-   **Full Profile Access**: Expanded the "Add User" form to include **Real Name, Phone, Telegram, Memo, and Tags**.
-   **Data Consistency**: Ensured profile fields are correctly persisted in the database via updated Pydantic schemas and service logic.
-   **CRM Search**: Enabled searching users by profile fields (Real Name, Tags) in the Member Management list.

### Ticket Management (Logs & Revoke)
-   **Unified Dashboard**: Integrated "Grant", "Logs", and "Revoke" into a single efficient interface.
-   **User Token Dashboard**: Searching by `external_id` now triggers a dedicated dashboard view showing:
    -   **Asset Cards**: Real-time balances for Roulette, Dice, Lottery, and CC Coin.
    -   **Quick Actions**: Inline [+ Grant] and [- Revoke] buttons directly on asset cards.
    -   **Context**: "Recent Play Logs" and "Ledger" displayed side-by-side.
-   **Reason-based Filtering**: Added category filters (**ADMIN, GAME, EXCHANGE**) to the Ticket Ledger to track specific asset flows.

### Message Center
-   **Frontend Completion**: Fully implemented the message composition and history UI.
-   **Advanced History**: Added **Search by Title** and **50-item Pagination** for the sent message logs.
-   **Targeting**: Integrated channel (In-App Inbox) and recipient targeting (All, Segment, Tag, User).

### Marketing Dashboard
-   **Metric Refinement**: Updated KPIs to include **Average Active Days, Charge Risk segments, and Tag Distribution**.
-   **Navigation**: Implemented clickable marketing cards that navigate to filtered user segments.

### Vault Management
-   **New "Vault Management" Page**: Added dedicated sidebar item.
-   **User Lookup**: Integrated specific search component to find users by `external_id`, `nickname`, or `id` to easily populate Eligibility and Timer control fields.

### User & Ranking Management
-   **External ID Focus**: Added `external_id` column to Member Management table and enabled search by it.
-   **Ranking UI**: Polished the Ranking Input styling and feedback.

## ğŸ›  Fixes & Cleanup
-   **Team Battle Admin**: Fixed 404 error by correctly prefixing API calls with `/admin/api`.
-   **Navigation**: Removed legacy "Feature Schedule" page.
-   **Dashboard**: Added tooltips to metrics (Active Users, Game Participation, etc.) for better clarity.

## âœ… Verification & Testing
-   **Automated Test Script**: Created `tests/test_admin_flow.py` to verify core admin actions (Grant, Vault, Ranking) at the service level.
-   **Docker Verification**: Validated all changes and tests within the `xmas-backend` Docker container.
-   **Instructional Build**: Successfully verified `npm run build` with no type errors.

## ğŸ“ Artifacts
-   `admin_test_scenarios.md`: Documented manual test flows.
-   `walkthrough.md`: Detailed changelog and verification guide.
